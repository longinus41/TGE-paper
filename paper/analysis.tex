% !TEX root = main.tex

\section{Preliminary Analysis}
In the paper we analysis the Ethereum trading graph (ETG, for short) since Ethereum is the largest blockchain platform that supports cryptocurrency transferring and smart contracts. This section investigates the accounts and transactions on Ethereum since they are the basic unit of Ethereum and represent the nodes and edges in ETG respectively.


\subsection{Accounts}
In Ethereum, there are two kinds of accounts, external owned accounts and smart contracts, namely EOAs and SCs for short. The major difference between is that SCs are ruled by executable codes inside whereas EOAs are controlled by people who hold the public-private key pairs. Other than that, they do not look a whole lot different in Ethereum system. Both of them have unique addresses, the address of EOA is determined by the public key and the address of SC is encoded when SC is created. We use the terms address and account interchangeably in the remainder of this paper.

The real identities behind these addresses can be multitudinous and the anonymity of blockchain makes the identification more difficult. Generally, these addresses can be classified into different categories according to user roles on the blockchain.

%Here we take the category of address and the identity behind it as the same, although an individual or a group may has multiple address.

1) \emph{Miners \& Mining Pools}

Similar to Bitcoin, Ethereum takes \emph{Proof-of-Work} as its consensus protocol\footnote{Although Ethereum \emph{Casper} will abandon the PoW protocol, the current Ethereum is on the third stage \emph{Metropolis} which still mainly relies on solving hash problem.}. The \textbf{miners} are the individuals or groups who validate transaction information by solving the cryptographic puzzles. Whoever is the first to find a valid hash of block will get the reward in the form of ETH which is paid by users sending transactions.

In the early stage, most people take part in the mining process independently. With the more participants into this high profit industry, the mining competition gradually becomes fiercer. And an efficient solution is working together to solve the PoW problems. Miners with mining machines can register on a special institution named \textbf{mining pool} where aggregates all the registrants' computing power to solve mining problem and distributes the reward to the registrants according to their proportion of contributed computing power. As of September 2018, top $3$ mining pools takes more than 65\% of hash rate in Ethereum\footnote{Investoon, https://investoon.com/charts/mining/eth.}.
%The centralized institution is \textbf{mining pool} and these registrants are so called \textbf{cooperative miners}.


% And, more remarkable, the percentage of standalone miners declined and dropped to almost zero in the end of 2017. 

2) \emph{ERC-20 \& ICO}

ERC-20 is a technical standard used for smart contracts on the Ethereum blockchain for implementing tokens~\cite{erc-20-wiki}. It defines a common list of rules that an Ethereum token has to implement, giving developers the ability to program how new tokens will function within the Ethereum ecosystem. An ERC-20 token transfer happens in specific SCs which are called \textbf{ERC-20 token contracts}. %and the transferring process will be illustrated later. 

The ERC-20 token standard became popular with crowdfunding companies working on ICO cases due to the simplicity of deployment, together with its potential for interoperability with other Ethereum token standards~\cite{erc-20}. As of July 26 2018, there were more than 103,621 ERC-20 token contracts\footnote{Etherscan Token Tracker Page, https://etherscan.io/tokens}. Among the most successful ERC-20 token sales are EOS, Filecoin, Bancor, Qash, and Nebulas, raising over 60 million each\footnote{``Token Data, data and analytics for all ICO's and tokens", https://www.tokendata.io}.

Participants in the initial ICO round are \textbf{primary market investors} who buy the ERC-20 token from ERC-20 smart contracts of the crowdfunding companies. And these addresses where token sale proceeds are \textbf{ICO wallets}.

3) \emph{Exchanges}

The exchanges are the platforms for trading between ETH, fiat money (e.g., USD) and even other digital currency (e.g., BTC and ERC-20 tokens), which play an important role in Ethereum ecosystem. The exchanges can be categorized into centralized exchanges and decentralized exchanges (also known as DEXs) according to their architectures.

Most of the worldâ€™s cryptocurrency trading is done through centralized exchanges such as Binance, Huobi, OKEX etc\footnote{``Top 100 Cryptocurrency Exchanges by Trade Volume'', https://coinmarketcap.com/rankings/exchanges}. The centralized exchange allocates a deposit address to each user who wants to make transaction in the exchange. These addresses are called \textbf{exchange deposits} and belong to the exchange since users do not have the private key of these addresses. In recharge process, user transfers coins to the given deposit address from her own wallet and these coins will be transferred to the \textbf{exchange root} address automatically. In turn, users send requests to exchange to withdraw their coins from an address called \textbf{exchange withdrawal}. And in most cases, the exchange root and exchange withdrawal mean the same address.

%The exchange charges the user a commission for both recharge and withdraw services.

The DEXs are a new technology that facilitate cryptocurrency trading on a distributed ledger. Being completely on-chain, all orders interact with each other directly through the blockchain. This makes it fully decentralized, but also expensive and slow. Besides, another difference is that user will get a new address with corresponding private key when registers to the DEX, which means the address belongs to user itself instead of exchange. 
 
 %User calls the smart contract in the decentralized exchange address to start a transaction. Intuitively, the transaction will take a long time for making match and confirming compared with in centralized way.

%Since most ERC-20 token transactions happen via smart contracts and in a decentralized mechanism, some big exchanges which support both ETH and ERC-20 token transaction (e.g., Binance and Huobi) are mixture of centralized and decentralized exchange. 

4) \emph{Phishes \& Hacks}

Since virtual property transactions are now becoming increasingly commonplace and that leads to many security issues. At the same time, the frauds associated with ETH and ERC-20 tokens have also increased. We call these addresses related to frauds \textbf{phishes \& hacks}.

 In Ethersacan, there are more than $2500$ addresses are labeled as Phish/Hack, which takes up the highest proportion. Most of them are disguised as ERC-20 token sales or DApps such as casino. 

\begin{table}[htbp]
\caption{Typical Account Identities}
\begin{center}
\begin{tabular}{|p{1.8cm}|c|p{3.9cm}|}
\hline
\textbf{Identity} & \textbf{Type}& \textbf{Description} \\
\hline
Miner & EOA & The node who take part in the block validation process. \\ \hline
Mining Pool & EOA & The pooling of resources by miners, who share their processing power over a network.\\ \hline
ERC-20 Token Contract & SC & Smart contract that allow customers to transfer ERC-20 tokens. \\ \hline
Primary Market Investor & EOA & Participants in the initial ICO round. \\ \hline
ERC-20 Token Sale & EOA\&SC & Address that allows customers to buy ERC-20 tokens. \\ \hline
Exchange Deposit & EOA\&SC & Address for user to deposit ETH at exchange. \\ \hline
Exchange Root \& Withdrawal & EOA\&SC & Address collects ETH from deposit addresses and withdraw ETH to users. \\ \hline
Phish \& Hack & EOA\&SC & Fraud address related to phishing and hacks. \\ \hline
%\multicolumn{4}{l}{$^{\mathrm{a}}$Sample of a Table footnote.}
\end{tabular}
\label{tab1}
\end{center}
\end{table}



%Phishing is the name given to the latest online scam where millions of unwary Americans are getting their identities stolen.

%We've seen increased use of sophisticated forms and letterhead to send what appears to be legitimate World Bank Group correspondence, as well as several schemes that reference the Bank.


\subsection{Transactions}
Transaction is the basic unit in each block which represents an action between two accounts. Transaction can be categorized as external one and internal one based on the sponsor of the transaction. A transaction is the external one if it is sent from an EOA while the internal one results from executing a smart contract due to an external transaction~\cite{chen2018infocom}. Note that an external transaction may lead to many internal transactions.

Four types of transaction can be found by parsing Ethereum blocks, including \emph{CALL}, \emph{CRATE}, \emph{REWARD} and \emph{SUICIDE}. As shown in Fig.?, ETH transferring and smart contract invoking comes with a \emph{CALL} transaction usually and \emph{CREATE} is used to deploy smart contracts. \emph{REWARD} transactions appears on the head of block, which depicts the reward that block miner obtained from system. The sender of \emph{REWARD} transaction is a special address \emph{0x00...00}. In the \emph{SUICIDE} transaction, the smart contract will execute destroy method to kill itself at the end of it's cycle. \emph{CALL}, \emph{CREATE} and \emph{SUICIDE} transactions can be either external transactions or internal transactions since the initiator can be both EOA and SC.

Various activities are realized on Ethereum based on the above mentioned transactions. Money transfer, contract creation and contract invocation are three major activities happening on Ethereum\cite{chen2018infocom}. \textcolor{gray}{The on-chain assets include ETH coin and ERC-20 token.} An typical ETH transfer is shown in Fig. ? in where the initiate address and target address can be both EOA and SC. In the \emph{CALL} transaction information, the amount to be transferred is a non-zero number. However, the process of ERC-20 token transfer is more complicated. The sponsor A (also called initiator) make a \emph{CALL} transaction to the ERC-20 smart contract to tell that he want to transfer ERC-20 token to somebody B. Then the smart contract will check the request and complete the deal if A has enough ERC-20 token. Note that the target address of the \emph{CALL} transaction is the ERC-20 SC instead of B address and the transfer value is $0$ ETH since the actual transfer happens in the smart contract where the ERC-20 token is transferred from A account to B account in the smart contract inner database. 


